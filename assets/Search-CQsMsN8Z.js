import{p as le,B as ie,t as h,f as C,s as i,e as c,g as $,h as V,i as s,j as y,H as U,T as D,F as A,L as R,M as ce,N as O,c as v,b as de,J as pe,V as Z,X as ue,E as k,d as ve,K as H,u as S,I as he}from"./index-D9OO_WAk.js";import{i as x}from"./if-D-Bg59Ce.js";import{e as me}from"./each-Czn-2FYz.js";import{s as K}from"./Sheet-CsUdCbJI.js";import{b as fe}from"./_commonjsHelpers-VtfsyDff.js";import{T as ge}from"./Track-_OC2i8Xp.js";import{J as Q,u as W}from"./Dash-CXzpqKZG.js";import"./Lyrics-CINP-40_.js";import"./this-Crh4RdfS.js";import"./svelte-head-BFOuCjRf.js";import"./services.svelte-Tr3niDee.js";import"./ssh-B_Sqzl7a.js";import"./legacy-DPIB7Lcu.js";var xe=(z,I)=>$(I,""),be=h('<button class="p-0 m-0 h-[75%] max-w-[5%] bg-transparent" aria-label="clear search text"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-[1.3em] text-zinc-500"><path fill-rule="evenodd" d="M10 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16ZM8.28 7.22a.75.75 0 0 0-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 1 0 1.06 1.06L10 11.06l1.72 1.72a.75.75 0 1 0 1.06-1.06L11.06 10l1.72-1.72a.75.75 0 0 0-1.06-1.06L10 8.94 8.28 7.22Z" clip-rule="evenodd"></path></svg></button>'),we=h('<span class="animate-pulse">Loading(proxy -> server).</span>'),_e=h('<span class="text-[8px] text-black/80 dark:text-white/80"> </span>'),ye=h(" <!>",1),ke=h('<h2 class="text-black dark:text-white font-medium w-dvw text-[9px] font-mono mt-2 px-2 select-none"><!> <span class="text-[8px] text-black/80 dark:text-white/80 bg-black/5 dark:bg-white/5 p-0.5 rounded-xs">Powered by JioSaavn</span></h2> <!>',1),Se=h("<span>Svara is connected with <b> </b> </span>"),$e=h('<div class="px-2"><h1 class="text-black dark:text-white font-semibold text-center mt-[1em] mb-2 text-xl border-b border-black/10 dark:border-white/10">ðŸŽ¶ Search for Music!</h1> <p class="text-black/80 dark:text-white/80 text-sm">Find for your favorite songs, playlists, artists and more! <!></p></div>'),Ie=h('<div class="p-2 pb-1 text-black dark:text-white h-[7dvh]"><div class="relative w-full bg-black/5 dark:bg-white/5 ring-1 ring-black/10 dark:ring-white/10 rounded-md flex flex-row items-center justify-center space-x-[0.2ch] text-[16px] h-full px-[1ch]"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"></path></svg> <input type="text" placeholder="find songs &amp; playlists"> <!></div></div> <div><!></div>',1);function Fe(z,I){le(I,!0);const[B,X]=pe(),m=()=>U(Z,"$ViewInfo",B),L=()=>U(ue,"$config",B);let r=ie({loading:!1}),T=V(""),j=V(!1),J=V("");const G=(e,t=500)=>{let o=null;return(...d)=>{o||(o=setTimeout(()=>{e(...d),o=null},t))}};async function Y(e,t,o){const d=Date.now(),l=`cache-${e}`;if(localStorage.getItem(l)){if(!localStorage.getItem(l))return;const u=JSON.parse(localStorage.getItem(l));if(u){if(d<u.expiry)return u.data;localStorage.removeItem(l)}}const p=await t();return localStorage.setItem(l,JSON.stringify({data:p,expiry:d+o})),p}const ee=G(()=>{let e=s(T);!e||e.length<3||r.query&&e==r.query||(r.loading=!0,Y(`search-${e}`,()=>Q.query(e),60*60*1e3).then(t=>{t.results=t.results.map(o=>(o.image=o.image.replace("http://","https://"),o)),r.query=e,r.songs=t,r.loading=!1}))},1e3);var E=Ie(),M=C(E),F=c(M),N=c(F),b=i(N,2);b.__keyup=e=>{const t=e.target;if(e.key=="Enter"){t.blur();return}t.value=t.value.replace(/[^a-zA-Z0-9 '-]/g,""),$(T,t.value.trim(),!0),s(T)!=""&&($(j,t.value.length>2),ee())};var te=i(b,2);{var ae=e=>{var t=be();t.__click=[xe,J],R(3,t,()=>O,()=>({duration:100})),v(e,t)};x(te,e=>{s(j)&&e(ae)})}var w=i(M,2),re=c(w);{var se=e=>{var t=ke(),o=C(t),d=c(o);{var l=n=>{var a=we();v(n,a)},p=n=>{var a=ye(),f=C(a),_=i(f);{var q=g=>{var P=_e(),ne=c(P);y(()=>k(ne,`â€”out of ${r.songs.total??""}`)),v(g,P)};x(_,g=>{r.songs.total>10&&g(q)})}y(()=>k(f,`showing ${r.songs.results.length??""} result${r.songs.results.length>1?"s":""} `)),v(n,a)};x(d,n=>{r.loading?n(l):n(p,!1)})}var u=i(o,2);me(u,17,()=>r.songs.results||[],n=>n.id,(n,a)=>{const f=he(()=>W.info.meta.id==s(a).id);ge(n,{get track(){return s(a)},get playing(){return s(f)},onPlay:async()=>{var g;const _=await Q.getDownloadableURLs(s(a));if(_.length==0){console.error("no media url found for track");return}const q=(g=_.at(-1))==null?void 0:g.url;W.playback.play({id:s(a).id,title:s(a).title,img:s(a).image.replace("http://","https://"),artist:s(a).more_info.artistMap.primary_artists[0].name||"",album:s(a).more_info.album||""},q)},onMoreActions:()=>{H(Z,S(m).sheets.actions=!0,S(m)),H(Z,S(m).select.track=s(a),S(m))}})}),v(e,t)},oe=e=>{var t=$e(),o=i(c(t),2),d=i(c(o));{var l=p=>{var u=Se(),n=i(c(u)),a=c(n),f=i(n);y(()=>{k(a,`${L().connections.jiosaavn.data.meta.firstname??""}'s`),k(f,`(${L().connections.jiosaavn.data.meta.username??""}) JioSaavn
            Account.`)}),v(p,u)};x(d,p=>{L().connections.jiosaavn.active&&p(l)})}v(e,t)};x(re,e=>{r.songs?e(se):e(oe,!1)})}y(()=>{K(M,`display: ${m().tab==D.search?"block":"none"};`),A(N,0,`h-[1.3em] max-w-[5%] ${r.loading?"animate-pulse text-purple-600 dark:text-purple-500 stroke-2":"text-zinc-500"}`),A(b,1,`bg-transparent ring-0 focus:outline-hidden rounded-md py-0 h-full placeholder:text-black/50 dark:placeholder:text-white/50 ${s(j)?"w-[90%]":"w-[95%]"}`),A(w,1,`items-center justify-center space-y-0 max-h-[93dvh] h-[93dvh] overflow-y-scroll pb-[20dvh] rounded-t-xl bg-transparent no-scrollbar w-full ${r.loading?"animate-pulse":""}`),K(w,`display: ${m().tab==D.search?"block":"none"};`)}),fe(b,()=>s(J),e=>$(J,e)),R(3,F,()=>ce,()=>({duration:500,y:-100})),R(3,w,()=>O,()=>({duration:1e3})),v(z,E),de(),X()}ve(["keyup","click"]);export{Fe as default};
